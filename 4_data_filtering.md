# Курс «Симулятор SQL»

## 4 урок Фильтрация данных

### Практика

#### [Задача 1](https://lab.karpov.courses/learning/152/module/1762/lesson/18485/53202/251020)

<details>

Фильтрация данных позволяет включать в результирующий запрос не все строки исходной таблицы, а только те, которые соответствуют заранее заданному условию.

В SQL для фильтрации данных используется оператор WHERE. После оператора WHERE указывается логическое выражение, результат которого определяет, будет ли строка включена в результирующую таблицу. Если условие оказывается истинным (TRUE), то строка включается в результат, если ложным (FALSE) — строка исключается.

Таким образом, каждая строка в таблице проходит проверку на соответствие определённому условию, и в результате этих проверок формируется таблица, над которой затем проводятся операции, указанные в блоке SELECT.

Оператор WHERE и логическое выражение указываются после блока FROM:

```sql
SELECT column_1, column_2
FROM table
WHERE column_2 >= 0
```

Например, в результате указанного выше запроса в выборку попадут только записи с неотрицательными значениями в колонке column_2.

В свою очередь операторы ORDER BY и LIMIT записываются уже после оператора WHERE. Если добавить их в пример выше, то запрос будет выглядеть так:

```sql
SELECT column_1, column_2
FROM table
WHERE column_2 >= 0
ORDER BY column_1
LIMIT 100
```

В результате мы сначала отфильтруем необходимые нам строки, затем выберем столбцы, отмеченные в SELECT, а потом отсортируем результирующую таблицу, ограничив число выводимых записей.

Таким образом, порядок записи известных нам на текущий момент ключевых слов выглядит так:

```sql
SELECT
FROM
WHERE
ORDER BY
LIMIT
```

Снова обратим внимание, что порядок их выполнения отличается от того, в какой последовательности они указываются в запросе:

Сначала выполняется оператор FROM — происходит выбор нужной таблицы.
Далее WHERE — отфильтровываются строки, соответствующие условию.
Затем SELECT — отбираются указанные столбцы и применяются функции.
Потом ORDER BY — производится сортировка результирующей таблицы.
И в самом конце LIMIT — ограничивается количество выводимых записей.
Иными словами, в результате выполнения запроса сначала происходит подготовка таблицы к работе, а уже затем над ней выполняются разные операции.

`На заметку:`

Подробнее про оператор WHERE можно почитать здесь.

А теперь давайте порешаем задачи на фильтрацию данных и научимся применять оператор WHERE в сочетании с логическими выражениями. Начнём с простого.

</details>

`Задание:`

Напишите SQL-запрос к таблице products и выведите всю информацию о товарах, цена которых не превышает 100 рублей. Результат отсортируйте по возрастанию id товара.

Поля в результирующей таблице: `product_id, name, price`

`Пояснение:`

Если вы успели подзабыть логические выражения, то рекомендуем вернуться к этому шагу.

```sql

SELECT *
FROM   products
WHERE  price <= 100
ORDER BY product_id asc

```

#### [Задача 2](https://lab.karpov.courses/learning/152/module/1762/lesson/18485/53202/288781)

<details>

Фильтровать данные в таблицах можно не только по полям с числовыми значениями, но и по полям со значениями, представленными в виде текста:

```sql
SELECT column_1, column_2
FROM table
WHERE column_2 = 'text'
```

В примере выше в результирующую таблицу попадут только строки, значения в которых полностью совпадают с указанной в WHERE строкой 'text'. 

При сравнении строк также допускается использовать неравенства:

```sql
SELECT column_1, column_2
FROM table
WHERE column_2 > 'text'
```

Впрочем, такая операция используется реже, поскольку не вполне очевидно, что означает «одна строка больше другой».

На самом деле порядок сортировки данных строкового типа обычно определяется заранее установленными правилами сортировки, при которых значение имеют длина строки в символах, порядок букв в соответствии с алфавитом, наличие особых символов, регистр и т.д. Мы не будем подробно останавливаться на этой теме — при желании об этом можно дополнительно прочитать в документации.

`На заметку:`

Подробнее о правилах сортировки данных строкового типа можно почитать здесь.

</details>


`Задание:`

Отберите пользователей женского пола (female) из таблицы users. Выведите только `id` этих пользователей. Результат отсортируйте по возрастанию `id`.

Добавьте в запрос оператор `LIMIT` и выведите только `1000` первых `id` из отсортированного списка.

Поле в результирующей таблице: `user_id`

`Пояснение:`

Обратите внимание, что в SELECT можно не включать колонку, которая используется для фильтрации в операторе WHERE. Так, например, в этом задании мы не включаем в результат колонку с полом пользователя.

```sql

SELECT user_id
FROM   users
WHERE  sex = 'female'
ORDER BY user_id ASC LIMIT 1000

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```

#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```


#### [Задача ]()

<details>

</details>

```sql

```
